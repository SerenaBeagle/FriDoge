<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>FriDoge Demo</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --pink: #F6C1CC;
      --brown: #6B4F3F;
      --yellow: #F4D06F;
      --cream: #FFF7ED;
      --card: #FFFFFF;
      --line: #EAD7CB;
      --shadow: rgba(107, 79, 63, 0.18);
    }

    * { box-sizing: border-box; font-family: 'Nunito', sans-serif; }

    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(180deg, #FBE4E9, #FFF7ED);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 18px;
      padding-bottom: calc(18px + env(safe-area-inset-bottom));
    }

    /* ===== Outer shell becomes responsive ===== */
    .shell {
      width: 100%;
      max-width: 980px; /* desktop can be wider now */
    }

    .app {
      width: 100%;
      background: var(--card);
      border-radius: 26px;
      padding: 22px;
      box-shadow: 0 18px 40px var(--shadow);
      position: relative;
      overflow: hidden;
    }

    /* ===== Language Toggle ===== */
    .lang-toggle {
      position: absolute;
      top: 14px;
      right: 16px;
      background: #FFF;
      border: 2px solid var(--line);
      border-radius: 999px;
      overflow: hidden;
      display: flex;
      font-size: 12px;
      user-select: none;
      z-index: 5;
    }
    .lang-toggle span {
      padding: 6px 10px;
      cursor: pointer;
      color: var(--brown);
    }
    .lang-toggle .active {
      background: var(--yellow);
      font-weight: 700;
    }

    .header { text-align: center; margin-top: 12px; margin-bottom: 10px; }
    .header h1 { margin: 0; font-size: 28px; color: var(--brown); letter-spacing: -0.3px; }
    .header p { margin-top: 6px; font-size: 14px; color: #8A6E5A; }

    .pill {
      margin: 14px auto 0;
      width: fit-content;
      background: #FFF8DC;
      border: 1px dashed #E4C9A8;
      color: #6B4F3F;
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
    }

    /* ===== Main layout: mobile 1-col, desktop 2-col ===== */
    .layout {
      margin-top: 16px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }

    .panel {
      background: rgba(255, 247, 237, 0.35);
      border: 1px solid rgba(234, 215, 203, 0.8);
      border-radius: 20px;
      padding: 14px;
    }

    .section { margin-top: 14px; }
    .section:first-child { margin-top: 0; }

    label {
      display: block;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--brown);
    }

    textarea, select, input {
      width: 100%;
      border-radius: 16px;
      padding: 11px 12px;
      border: 2px solid var(--line);
      background: var(--cream);
      font-size: 14px;
      color: #4A372D;
      outline: none;
    }

    textarea { resize: none; }

    textarea:focus, select:focus, input:focus {
      border-color: var(--pink);
      background: #FFF;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .hint {
      margin-top: 6px;
      font-size: 12px;
      color: #9C7C6A;
    }

    .button-wrapper { margin-top: 16px; text-align: center; }

    button {
      width: 100%;
      max-width: 360px;
      background: var(--yellow);
      color: var(--brown);
      border: none;
      border-radius: 999px;
      padding: 13px 22px;
      font-size: 15px;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 10px 22px rgba(244, 208, 111, 0.55);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 14px 28px rgba(244, 208, 111, 0.65); }
    button:active { transform: translateY(0px); }

    /* ===== Reaction panel ===== */
    .reaction-wrap {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .reaction-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .reaction-title h3 {
      margin: 0;
      font-size: 14px;
      color: var(--brown);
      font-weight: 800;
      letter-spacing: -0.2px;
    }

    .mini-btns {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .mini-btn {
      border: 1px solid var(--line);
      background: #fff;
      color: var(--brown);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
    }
    .mini-btn:hover { filter: brightness(0.98); }

    .reaction {
      background: #FFF8DC;
      border-radius: 18px;
      padding: 14px 16px;
      min-height: 140px;
      font-size: 14px;
      line-height: 1.65;
      white-space: pre-wrap;
      color: #5A4033;
      border: 1px solid rgba(228, 201, 168, 0.8);
    }
    .reaction.loading { opacity: 0.75; font-style: italic; }

    .footer-note {
      margin-top: 10px;
      font-size: 11px;
      color: #A18673;
      text-align: center;
    }

    /* ===== Desktop enhancements ===== */
    @media (min-width: 860px) {
      body { padding: 24px; padding-bottom: calc(24px + env(safe-area-inset-bottom)); }
      .app { padding: 26px; }
      .header h1 { font-size: 32px; }
      .layout {
        grid-template-columns: 1.05fr 0.95fr; /* left: inputs, right: result */
        gap: 18px;
        align-items: start;
      }
      .panel { padding: 18px; border-radius: 22px; }

      /* Sticky result on desktop for nice UX */
      .right-panel {
        position: sticky;
        top: 18px;
      }

      /* Make reaction scroll inside the right panel */
      .reaction {
        min-height: 520px;
        max-height: 62vh;
        overflow: auto;
      }
    }

    /* ===== Small phones ===== */
    @media (max-width: 380px) {
      .grid-2 { grid-template-columns: 1fr; }
      .lang-toggle { top: 10px; right: 10px; }
      .header h1 { font-size: 26px; }
    }
  </style>
</head>

<body>
  <div class="shell">
    <div class="app">

      <!-- Language Toggle -->
      <div class="lang-toggle">
        <span id="lang-en" class="active" onclick="setLang('en')">EN</span>
        <span id="lang-zh" onclick="setLang('zh')">‰∏≠Êñá</span>
      </div>

      <div class="header">
        <h1>üê∂ FriDoge ÂÜ∞Áãó</h1>
        <p id="subtitle">Your cozy fridge assistant</p>
        <div class="pill" id="pill">‚ú® Quick demo: fridge ‚Üí goal ‚Üí reaction</div>
      </div>

      <div class="layout">
        <!-- LEFT: inputs -->
        <div class="panel left-panel">

          <!-- People + Appetite -->
          <div class="section">
            <label id="label-people">üë• How many people?</label>
            <div class="grid-2">
              <div>
                <input id="people" type="number" min="1" step="1" value="1" />
                <div class="hint" id="hint-people">Set 1 for solo meal</div>
              </div>
              <div>
                <label id="label-appetite" style="margin-bottom:6px;">üçΩÔ∏è Appetite</label>
                <select id="appetite">
                  <option value="small">Small</option>
                  <option value="normal" selected>Normal</option>
                  <option value="big">Big</option>
                </select>
                <div class="hint" id="hint-appetite">Helps portion sizing</div>
              </div>
            </div>
          </div>

          <!-- Goal -->
          <div class="section">
            <label id="label-goal">üéØ Choose a style</label>
            <select id="goal">
              <option value="fat_loss" selected>Fat loss / ÂáèËÑÇ</option>
              <option value="muscle_gain">Muscle gain / Â¢ûËÇå</option>
              <option value="low_sugar">Low sugar / ÊéßÁ≥ñ</option>
              <option value="cheat_meal">Cheat meal / Ê¨∫È™óÈ§ê</option>
              <option value="whatever">Whatever / Èöè‰æøÂêÉ</option>
            </select>
            <div class="hint" id="hint-goal">FriDoge will adapt tone + recipe choices</div>
          </div>

          <!-- Fridge items -->
          <div class="section">
            <label id="label-items">ü•¶ What's in your fridge?</label>
            <textarea id="items" rows="4" placeholder="milk, eggs, broccoli"></textarea>
            <div class="hint" id="hint-items">Tip: separate items by commas</div>
          </div>

          <!-- Main request -->
          <div class="section">
            <label id="label-request">üí≠ What do you want today?</label>
            <textarea id="request" rows="3" placeholder="I want a healthy and easy meal today"></textarea>
          </div>

          <!-- Extra -->
          <div class="section">
            <label id="label-extra">üß© Personal needs (optional)</label>
            <textarea id="extra" rows="3" placeholder="e.g. no dairy, 15-min cooking, spicy, high protein, period-friendly..."></textarea>
            <div class="hint" id="hint-extra">Allergies / dislikes / time limit / cookware</div>
          </div>

          <div class="button-wrapper">
            <button id="ask-btn" onclick="send()">Ask FriDoge üêæ</button>
          </div>

          <div class="footer-note" id="footer-note">
            üê∂ Tip: later you can add cute images/illustrations without changing the logic.
          </div>
        </div>

        <!-- RIGHT: result -->
        <div class="panel right-panel">
          <div class="reaction-wrap">
            <div class="reaction-title">
              <h3 id="reaction-title">üßæ AI Reaction</h3>
              <div class="mini-btns">
                <button class="mini-btn" onclick="copyResult()">Copy</button>
                <button class="mini-btn" onclick="clearResult()">Clear</button>
              </div>
            </div>
            <div id="result" class="reaction">FriDoge is waiting for your fridge info üßä</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    let currentLang = "en";

    const textMap = {
      en: {
        subtitle: "Your cozy fridge assistant",
        pill: "‚ú® Quick demo: fridge ‚Üí goal ‚Üí reaction",
        people: "üë• How many people?",
        hintPeople: "Set 1 for solo meal",
        appetite: "üçΩÔ∏è Appetite",
        hintAppetite: "Helps portion sizing",
        goal: "üéØ Choose a style",
        hintGoal: "FriDoge will adapt tone + recipe choices",
        items: "ü•¶ What's in your fridge?",
        hintItems: "Tip: separate items by commas",
        request: "üí≠ What do you want today?",
        extra: "üß© Personal needs (optional)",
        hintExtra: "Allergies / dislikes / time limit / cookware",
        ask: "Ask FriDoge üêæ",
        thinking: "üê∂ FriDoge is thinking...",
        waiting: "FriDoge is waiting for your fridge info üßä",
        footer: "üê∂AI Dog is training...",
        reactionTitle: "üßæ AI Reaction",
        copied: "‚úÖ Copied!"
      },
      zh: {
        subtitle: "‰Ω†Ë¥¥ÂøÉÁöÑÂÜ∞ÁÆ±Â∞èÁÆ°ÂÆ∂",
        pill: "‚ú® Âø´ÈÄüÊºîÁ§∫ÔºöÂÜ∞ÁÆ± ‚Üí ÁõÆÊ†á ‚Üí ÂÜ∞ÁãóÂª∫ËÆÆ",
        people: "üë• Âá†‰∏™‰∫∫ÂêÉÔºü",
        hintPeople: "‰∏Ä‰∏™‰∫∫Â∞±Â°´ 1",
        appetite: "üçΩÔ∏è È£üÈáèÂ§ßÂ∞è",
        hintAppetite: "Áî®‰∫é‰º∞ÁÆó‰ªΩÈáè",
        goal: "üéØ ÈÄâÊã©È•ÆÈ£üÈ£éÊ†º",
        hintGoal: "ÂÜ∞Áãó‰ºöÊåâÁõÆÊ†áË∞ÉÊï¥ËØ≠Ê∞îÂíåÊé®Ëçê",
        items: "ü•¶ ÂÜ∞ÁÆ±ÈáåÊúâ‰ªÄ‰πàÔºü",
        hintItems: "ÊèêÁ§∫ÔºöÁî®ÈÄóÂè∑ÂàÜÈöîÈ£üÊùê",
        request: "üí≠ ‰Ω†‰ªäÂ§©ÊÉ≥Ë¶Å‰ªÄ‰πàÔºü",
        extra: "üß© ‰∏™ÊÄßÂåñÈúÄÊ±ÇÔºàÂèØÈÄâÔºâ",
        hintExtra: "ÂøåÂè£/ËøáÊïè/Êó∂Èó¥ÈôêÂà∂/Âé®ÂÖ∑/Âè£Âë≥Á≠â",
        ask: "ÈóÆÈóÆÂÜ∞Áãó üêæ",
        thinking: "üê∂ ÂÜ∞ÁãóÊ≠£Âú®ÊÄùËÄÉ‰∏≠...",
        waiting: "ÂÜ∞ÁãóÂú®Á≠â‰Ω†ÂëäËØâÊàëÂÜ∞ÁÆ±ÈáåÊúâ‰ªÄ‰πà üßä",
        footer: "üê∂ÂÜ∞ÁãóËøòÂú®ËÆ≠ÁªÉ‰∏≠...",
        reactionTitle: "üßæ ÂÜ∞ÁãóÂõûÂ§ç",
        copied: "‚úÖ Â∑≤Â§çÂà∂ÔºÅ"
      }
    };

    function setLang(lang) {
      currentLang = lang;

      document.getElementById("lang-en").classList.toggle("active", lang === "en");
      document.getElementById("lang-zh").classList.toggle("active", lang === "zh");

      document.getElementById("subtitle").innerText = textMap[lang].subtitle;
      document.getElementById("pill").innerText = textMap[lang].pill;

      document.getElementById("label-people").innerText = textMap[lang].people;
      document.getElementById("hint-people").innerText = textMap[lang].hintPeople;

      document.getElementById("label-appetite").innerText = textMap[lang].appetite;
      document.getElementById("hint-appetite").innerText = textMap[lang].hintAppetite;

      document.getElementById("label-goal").innerText = textMap[lang].goal;
      document.getElementById("hint-goal").innerText = textMap[lang].hintGoal;

      document.getElementById("label-items").innerText = textMap[lang].items;
      document.getElementById("hint-items").innerText = textMap[lang].hintItems;

      document.getElementById("label-request").innerText = textMap[lang].request;

      document.getElementById("label-extra").innerText = textMap[lang].extra;
      document.getElementById("hint-extra").innerText = textMap[lang].hintExtra;

      document.getElementById("ask-btn").innerText = textMap[lang].ask;
      document.getElementById("reaction-title").innerText = textMap[lang].reactionTitle;

      // ‰∏çÂº∫Ë°åË¶ÜÁõñÁî®Êà∑Â∑≤ÁªèÁîüÊàêÁöÑÁªìÊûúÔºõÂè™Âú®Á©∫Êó∂ËÆæÁΩÆ waiting
      const result = document.getElementById("result");
      if (!result.dataset.hasResult) {
        result.innerText = textMap[lang].waiting;
      }

      document.getElementById("footer-note").innerText = textMap[lang].footer;

      if (lang === "zh") {
        document.getElementById("items").placeholder = "ÁâõÂ•∂, È∏°Ëõã, Ë•øÂÖ∞Ëä±";
        document.getElementById("request").placeholder = "ÊàëÊÉ≥ÂêÉÂæóÂÅ•Â∫∑‰∏ÄÁÇπÔºåÂÅöÊ≥ïÁÆÄÂçï";
        document.getElementById("extra").placeholder = "ÊØîÂ¶ÇÔºö‰∏çÂêÉ‰π≥Âà∂ÂìÅ„ÄÅ15ÂàÜÈíüÊêûÂÆö„ÄÅÊÉ≥ÂêÉËæ£„ÄÅÈ´òËõãÁôΩ„ÄÅÂß®Â¶àÂèãÂ•Ω...";
      } else {
        document.getElementById("items").placeholder = "milk, eggs, broccoli";
        document.getElementById("request").placeholder = "I want a healthy and easy meal today";
        document.getElementById("extra").placeholder = "e.g. no dairy, 15-min cooking, spicy, high protein, period-friendly...";
      }
    }

    function clearResult() {
      const result = document.getElementById("result");
      result.dataset.hasResult = "";
      result.classList.remove("loading");
      result.innerText = textMap[currentLang].waiting;
    }

    async function copyResult() {
      const text = document.getElementById("result").innerText || "";
      try {
        await navigator.clipboard.writeText(text);
        // ÁÆÄÂçïÊèêÁ§∫Ôºö‰∏¥Êó∂ÊîπÊ†áÈ¢ò
        const t = document.getElementById("reaction-title");
        const old = t.innerText;
        t.innerText = textMap[currentLang].copied;
        setTimeout(() => (t.innerText = old), 900);
      } catch (e) {
        // ‰∏çÂº∫‰æùËµñ clipboard ÊùÉÈôê
        alert("Copy failed. Please select text and copy manually.");
      }
    }

    async function send() {
      const items = document.getElementById("items").value
        .split(",")
        .map(i => i.trim())
        .filter(Boolean);

      const request = document.getElementById("request").value;
      const extra = document.getElementById("extra").value;

      const people = parseInt(document.getElementById("people").value || "1", 10);
      const appetite = document.getElementById("appetite").value;
      const goal = document.getElementById("goal").value;

      const result = document.getElementById("result");
      result.innerText = textMap[currentLang].thinking;
      result.classList.add("loading");

      const API_BASE = "https://fri-doge.vercel.app";

      try {
        const res = await fetch(`${API_BASE}/api/react`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            lang: currentLang,
            items,
            request,
            extra,
            people,
            appetite,
            goal
          })
        });

        const data = await res.json();
        result.classList.remove("loading");
        result.dataset.hasResult = "1";
        result.innerText = data.result || JSON.stringify(data, null, 2);
      } catch (err) {
        result.classList.remove("loading");
        result.dataset.hasResult = "1";
        result.innerText = (currentLang === "zh")
          ? "‚ùå ËØ∑Ê±ÇÂ§±Ë¥•ÔºöËØ∑Ê£ÄÊü•ÁΩëÁªúÊàñ API Âú∞ÂùÄÊòØÂê¶Ê≠£Á°Æ„ÄÇ"
          : "‚ùå Request failed: please check network or API URL.";
      }
    }
  </script>
</body>
</html>
