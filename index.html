<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FriDoge Demo</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --pink: #F6C1CC;
      --brown: #6B4F3F;
      --yellow: #F4D06F;
      --cream: #FFF7ED;
      --card: #FFFFFF;
      --line: #EAD7CB;
    }

    * { box-sizing: border-box; font-family: 'Nunito', sans-serif; }

    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(180deg, #FBE4E9, #FFF7ED);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 18px;
    }

    .app {
      width: 100%;
      max-width: 460px;
      background: var(--card);
      border-radius: 24px;
      padding: 22px;
      box-shadow: 0 18px 40px rgba(107, 79, 63, 0.25);
      position: relative;
    }

    /* ===== Language Toggle ===== */
    .lang-toggle {
      position: absolute;
      top: 14px;
      right: 16px;
      background: #FFF;
      border: 2px solid var(--line);
      border-radius: 999px;
      overflow: hidden;
      display: flex;
      font-size: 12px;
      user-select: none;
    }
    .lang-toggle span {
      padding: 6px 10px;
      cursor: pointer;
      color: var(--brown);
    }
    .lang-toggle .active {
      background: var(--yellow);
      font-weight: 700;
    }

    .header { text-align: center; margin-top: 12px; margin-bottom: 10px; }
    .header h1 { margin: 0; font-size: 28px; color: var(--brown); }
    .header p { margin-top: 6px; font-size: 14px; color: #8A6E5A; }

    .pill {
      margin: 14px auto 0;
      width: fit-content;
      background: #FFF8DC;
      border: 1px dashed #E4C9A8;
      color: #6B4F3F;
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
    }

    .section { margin-top: 18px; }

    label {
      display: block;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--brown);
    }

    textarea, select, input {
      width: 100%;
      border-radius: 16px;
      padding: 11px 12px;
      border: 2px solid var(--line);
      background: var(--cream);
      font-size: 14px;
      color: #4A372D;
      outline: none;
    }

    textarea { resize: none; }

    textarea:focus, select:focus, input:focus {
      border-color: var(--pink);
      background: #FFF;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .hint {
      margin-top: 6px;
      font-size: 12px;
      color: #9C7C6A;
    }

    .button-wrapper { margin-top: 22px; text-align: center; }

    button {
      background: var(--yellow);
      color: var(--brown);
      border: none;
      border-radius: 999px;
      padding: 12px 26px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(244, 208, 111, 0.6);
      transition: all 0.2s ease;
    }

    button:hover { transform: translateY(-2px); box-shadow: 0 12px 26px rgba(244, 208, 111, 0.7); }

    .reaction {
      margin-top: 22px;
      background: #FFF8DC;
      border-radius: 18px;
      padding: 14px 16px;
      min-height: 88px;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
      color: #5A4033;
    }
    .reaction.loading { opacity: 0.75; font-style: italic; }

    .footer-note {
      margin-top: 12px;
      font-size: 11px;
      color: #A18673;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- Language Toggle -->
    <div class="lang-toggle">
      <span id="lang-en" class="active" onclick="setLang('en')">EN</span>
      <span id="lang-zh" onclick="setLang('zh')">‰∏≠Êñá</span>
    </div>

    <div class="header">
      <h1>üê∂ FriDoge ÂÜ∞Áãó</h1>
      <p id="subtitle">Your cozy fridge assistant</p>
      <div class="pill" id="pill">‚ú® Quick demo: fridge ‚Üí goal ‚Üí reaction</div>
    </div>

    <!-- New: People + Appetite -->
    <div class="section">
      <label id="label-people">üë• How many people?</label>
      <div class="grid-2">
        <div>
          <input id="people" type="number" min="1" step="1" value="1" />
          <div class="hint" id="hint-people">Set 1 for solo meal</div>
        </div>
        <div>
          <label id="label-appetite" style="margin-bottom:6px;">üçΩÔ∏è Appetite</label>
          <select id="appetite">
            <option value="small">Small</option>
            <option value="normal" selected>Normal</option>
            <option value="big">Big</option>
          </select>
          <div class="hint" id="hint-appetite">Helps portion sizing</div>
        </div>
      </div>
    </div>

    <!-- New: Goal Category -->
    <div class="section">
      <label id="label-goal">üéØ Choose a style</label>
      <select id="goal">
        <option value="fat_loss" selected>Fat loss / ÂáèËÑÇ</option>
        <option value="muscle_gain">Muscle gain / Â¢ûËÇå</option>
        <option value="low_sugar">Low sugar / ÊéßÁ≥ñ</option>
        <option value="cheat_meal">Cheat meal / Ê¨∫È™óÈ§ê</option>
        <option value="whatever">Whatever / Èöè‰æøÂêÉ</option>
      </select>
      <div class="hint" id="hint-goal">FriDoge will adapt tone + recipe choices</div>
    </div>

    <!-- Fridge items -->
    <div class="section">
      <label id="label-items">ü•¶ What's in your fridge?</label>
      <textarea id="items" rows="4" placeholder="milk, eggs, broccoli"></textarea>
      <div class="hint" id="hint-items">Tip: separate items by commas</div>
    </div>

    <!-- Main request -->
    <div class="section">
      <label id="label-request">üí≠ What do you want today?</label>
      <textarea id="request" rows="3" placeholder="I want a healthy and easy meal today"></textarea>
    </div>

    <!-- New: Personal constraints -->
    <div class="section">
      <label id="label-extra">üß© Personal needs (optional)</label>
      <textarea id="extra" rows="3" placeholder="e.g. no dairy, 15-min cooking, spicy, high protein, period-friendly..."></textarea>
      <div class="hint" id="hint-extra">Allergies / dislikes / time limit / cookware</div>
    </div>

    <div class="button-wrapper">
      <button id="ask-btn" onclick="send()">Ask FriDoge üêæ</button>
    </div>

    <div id="result" class="reaction">
      FriDoge is waiting for your fridge info üßä
    </div>

    <div class="footer-note" id="footer-note">
      üê∂ Tip: later you can add cute images/illustrations without changing the logic.
    </div>
  </div>

  <script>
    let currentLang = "en";

    const textMap = {
      en: {
        subtitle: "Your cozy fridge assistant",
        pill: "‚ú® Quick demo: fridge ‚Üí goal ‚Üí reaction",
        people: "üë• How many people?",
        hintPeople: "Set 1 for solo meal",
        appetite: "üçΩÔ∏è Appetite",
        hintAppetite: "Helps portion sizing",
        goal: "üéØ Choose a style",
        hintGoal: "FriDoge will adapt tone + recipe choices",
        items: "ü•¶ What's in your fridge?",
        hintItems: "Tip: separate items by commas",
        request: "üí≠ What do you want today?",
        extra: "üß© Personal needs (optional)",
        hintExtra: "Allergies / dislikes / time limit / cookware",
        ask: "Ask FriDoge üêæ",
        thinking: "üê∂ FriDoge is thinking...",
        waiting: "FriDoge is waiting for your fridge info üßä",
        footer: "üê∂ Tip: later you can add cute images/illustrations without changing the logic."
      },
      zh: {
        subtitle: "‰Ω†Ë¥¥ÂøÉÁöÑÂÜ∞ÁÆ±Â∞èÁÆ°ÂÆ∂",
        pill: "‚ú® Âø´ÈÄüÊºîÁ§∫ÔºöÂÜ∞ÁÆ± ‚Üí ÁõÆÊ†á ‚Üí ÂÜ∞ÁãóÂª∫ËÆÆ",
        people: "üë• Âá†‰∏™‰∫∫ÂêÉÔºü",
        hintPeople: "‰∏Ä‰∏™‰∫∫Â∞±Â°´ 1",
        appetite: "üçΩÔ∏è È£üÈáèÂ§ßÂ∞è",
        hintAppetite: "Áî®‰∫é‰º∞ÁÆó‰ªΩÈáè",
        goal: "üéØ ÈÄâÊã©È•ÆÈ£üÈ£éÊ†º",
        hintGoal: "ÂÜ∞Áãó‰ºöÊåâÁõÆÊ†áË∞ÉÊï¥ËØ≠Ê∞îÂíåÊé®Ëçê",
        items: "ü•¶ ÂÜ∞ÁÆ±ÈáåÊúâ‰ªÄ‰πàÔºü",
        hintItems: "ÊèêÁ§∫ÔºöÁî®ÈÄóÂè∑ÂàÜÈöîÈ£üÊùê",
        request: "üí≠ ‰Ω†‰ªäÂ§©ÊÉ≥Ë¶Å‰ªÄ‰πàÔºü",
        extra: "üß© ‰∏™ÊÄßÂåñÈúÄÊ±ÇÔºàÂèØÈÄâÔºâ",
        hintExtra: "ÂøåÂè£/ËøáÊïè/Êó∂Èó¥ÈôêÂà∂/Âé®ÂÖ∑/Âè£Âë≥Á≠â",
        ask: "ÈóÆÈóÆÂÜ∞Áãó üêæ",
        thinking: "üê∂ ÂÜ∞ÁãóÊ≠£Âú®ÊÄùËÄÉ‰∏≠...",
        waiting: "ÂÜ∞ÁãóÂú®Á≠â‰Ω†ÂëäËØâÊàëÂÜ∞ÁÆ±ÈáåÊúâ‰ªÄ‰πà üßä",
        footer: "üê∂ ÊèêÁ§∫Ôºö‰ª•ÂêéÂèØ‰ª•ÈöèÊó∂Âä†ÂèØÁà±ÊèíÁîªÔºå‰∏çÂΩ±ÂìçÈÄªËæë„ÄÇ"
      }
    };

    function setLang(lang) {
      currentLang = lang;

      document.getElementById("lang-en").classList.toggle("active", lang === "en");
      document.getElementById("lang-zh").classList.toggle("active", lang === "zh");

      document.getElementById("subtitle").innerText = textMap[lang].subtitle;
      document.getElementById("pill").innerText = textMap[lang].pill;

      document.getElementById("label-people").innerText = textMap[lang].people;
      document.getElementById("hint-people").innerText = textMap[lang].hintPeople;

      document.getElementById("label-appetite").innerText = textMap[lang].appetite;
      document.getElementById("hint-appetite").innerText = textMap[lang].hintAppetite;

      document.getElementById("label-goal").innerText = textMap[lang].goal;
      document.getElementById("hint-goal").innerText = textMap[lang].hintGoal;

      document.getElementById("label-items").innerText = textMap[lang].items;
      document.getElementById("hint-items").innerText = textMap[lang].hintItems;

      document.getElementById("label-request").innerText = textMap[lang].request;

      document.getElementById("label-extra").innerText = textMap[lang].extra;
      document.getElementById("hint-extra").innerText = textMap[lang].hintExtra;

      document.getElementById("ask-btn").innerText = textMap[lang].ask;
      document.getElementById("result").innerText = textMap[lang].waiting;
      document.getElementById("footer-note").innerText = textMap[lang].footer;

      // ‰Ω†‰πüÂèØ‰ª•È°∫ÊâãÊää placeholder ÂÅö‰∏≠Ëã±ÊñáÔºàÂèØÈÄâÔºâ
      if (lang === "zh") {
        document.getElementById("items").placeholder = "ÁâõÂ•∂, È∏°Ëõã, Ë•øÂÖ∞Ëä±";
        document.getElementById("request").placeholder = "ÊàëÊÉ≥ÂêÉÂæóÂÅ•Â∫∑‰∏ÄÁÇπÔºåÂÅöÊ≥ïÁÆÄÂçï";
        document.getElementById("extra").placeholder = "ÊØîÂ¶ÇÔºö‰∏çÂêÉ‰π≥Âà∂ÂìÅ„ÄÅ15ÂàÜÈíüÊêûÂÆö„ÄÅÊÉ≥ÂêÉËæ£„ÄÅÈ´òËõãÁôΩ„ÄÅÂß®Â¶àÂèãÂ•Ω...";
      } else {
        document.getElementById("items").placeholder = "milk, eggs, broccoli";
        document.getElementById("request").placeholder = "I want a healthy and easy meal today";
        document.getElementById("extra").placeholder = "e.g. no dairy, 15-min cooking, spicy, high protein, period-friendly...";
      }
    }

    async function send() {
      const items = document.getElementById("items").value
        .split(",")
        .map(i => i.trim())
        .filter(Boolean);

      const request = document.getElementById("request").value;
      const extra = document.getElementById("extra").value;

      const people = parseInt(document.getElementById("people").value || "1", 10);
      const appetite = document.getElementById("appetite").value;  // small/normal/big
      const goal = document.getElementById("goal").value;          // fat_loss/muscle_gain/...

      const result = document.getElementById("result");
      result.innerText = textMap[currentLang].thinking;
      result.classList.add("loading");

      const res = await fetch("http://localhost:3001/react", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          lang: currentLang,
          items,
          request,
          extra,
          people,
          appetite,
          goal
        })
      });

      const data = await res.json();
      result.classList.remove("loading");
      result.innerText = data.result;
    }
  </script>
</body>
</html>